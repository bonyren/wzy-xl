<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\common\service\Storage as StorageService; use app\index\service\Wzyer as WzyerService; class License extends Base { const KEY = "\171\x73\x73\107\67\x38\x48\110\x44\x7a\166\67\125\x6d\x38\126\x6b\x47\x54\105"; public function fetch() { goto btKyE; btKyE: $data = ["\x69\144" => null, "\145\155\141\151\154" => null, "\x61\x75\x74\150\137\x6b\145\171" => null, "\142\x69\156\x64\137\x74\x69\x6d\145" => null, "\166\x69\160\137\144\165\145\137\x64\x61\164\145" => null]; goto Eyyoh; Eyyoh: try { goto HMYzM; HMYzM: if (!StorageService::getInstance()->WZYER_AUTH) { goto ODSra; } goto oWjPs; oWjPs: $data = array_merge($data, json_decode(xorEnde(base64_decode(StorageService::getInstance()->WZYER_AUTH), self::KEY), true)); goto XQIbK; XQIbK: ODSra: goto RhRux; RhRux: } catch (\Exception $e) { StorageService::getInstance()->WZYER_AUTH = null; } goto WZM7Y; WZM7Y: return $data; goto jXiQF; jXiQF: } public function getBuyUrl() { $licenseData = $this->fetch(); return "\150\164\x74\x70\163\72\57\x2f\167\x77\x77\x2e\167\172\x79\x65\162\56\x63\157\x6d\x2f\x69\156\144\145\170\x2f\117\x70\145\156\x5f\x41\160\x69\x2f\164\x6f\x56\151\160\56\150\164\x6d\x6c\x3f\x65\155\x61\x69\154\x3d" . $licenseData["\x65\155\x61\151\154"]; } public function bind($authKey) { goto D8z9o; K9tvk: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto zl4Au; D8z9o: $result = WzyerService::I()->bindAuthKey($authKey); goto zvKy5; zvKy5: $data = ["\151\144" => $result["\151\x64"], "\x65\155\x61\x69\154" => $result["\x65\155\141\151\154"], "\141\165\164\150\137\153\x65\171" => $result["\x61\165\164\150\137\153\x65\x79"], "\x62\x69\156\144\x5f\x74\x69\x6d\x65" => date("\x59\x2d\155\x2d\x64\40\x48\72\x69\x3a\x73"), "\166\x69\160\137\144\x75\145\x5f\x64\x61\164\145" => $result["\x76\x69\160\x5f\x64\165\x65\x5f\144\141\164\145"]]; goto K9tvk; zl4Au: } public function unbind() { WzyerService::I()->unbindAuthKey(); StorageService::getInstance()->WZYER_AUTH = null; } public function refresh() { goto BnC36; BZ2qR: $result = WzyerService::I()->refreshAuthKey(); goto GiuDb; T_urK: qiLP7: goto BZ2qR; GiuDb: $data = ["\151\144" => $result["\x69\x64"], "\145\155\141\151\x6c" => $result["\x65\155\x61\x69\x6c"], "\141\x75\164\150\x5f\x6b\x65\171" => $result["\141\165\164\x68\137\153\145\171"], "\142\151\156\144\x5f\x74\151\155\x65" => $dataOld["\x62\151\156\144\137\x74\151\x6d\x65"] ?: date("\x59\55\x6d\55\144\40\x48\x3a\x69\72\x73"), "\166\x69\160\x5f\144\x75\x65\x5f\x64\x61\x74\145" => $result["\x76\x69\160\137\144\x75\145\x5f\144\x61\x74\x65"]]; goto EMCj5; EMCj5: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto e08F0; BnC36: $dataOld = $this->fetch(); goto Nmh5f; DJh09: return; goto T_urK; Nmh5f: if (!empty($dataOld["\x69\x64"])) { goto qiLP7; } goto DJh09; e08F0: } public function checkVip() { goto Y9q3V; ctSA8: MbWyM: goto jCi98; xp0_x: return false; goto YuEAB; fv7ms: return true; goto MPqVY; cp9DM: if (!empty($data["\151\144"])) { goto MbWyM; } goto Lvs6e; jCi98: if (!empty($data["\x76\x69\160\x5f\x64\165\145\137\144\x61\164\x65"])) { goto ApetP; } goto xp0_x; Lvs6e: return false; goto ctSA8; d8R8I: $today = date("\x59\x2d\155\x2d\x64"); goto JyrLY; YuEAB: ApetP: goto d8R8I; WYzFa: Sxw3Z: goto fv7ms; tMDg7: return false; goto WYzFa; JyrLY: if (!($today > $data["\166\151\x70\x5f\x64\x75\145\137\144\x61\x74\x65"])) { goto Sxw3Z; } goto tMDg7; Y9q3V: $data = $this->fetch(); goto cp9DM; MPqVY: } }
