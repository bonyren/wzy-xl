<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\index\service\EventLogs; use app\Defs; use app\index\model\Customer as CustomerModel; use app\index\service\RequestContext; class Customer extends Base { protected function __construct() { parent::__construct(); } public function load($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = '', $order = '') { goto e1vGE; yxHe3: return ["\x74\157\164\x61\154" => $totalCount, "\162\x6f\167\163" => $records]; goto O2bqL; xOFTY: if (emptyInArray($search, "\x63\145\x6c\x6c\160\x68\157\156\145")) { goto eEP5u; } goto tGwKZ; tGwKZ: $conditions["\x63\145\154\154\160\150\157\x6e\145"] = ["\x6c\151\x6b\145", "\x25" . $search["\x63\145\x6c\x6c\160\x68\157\x6e\145"] . "\x25"]; goto XCF07; G5d1f: cesF4: goto ObLt4; rc79f: $records = Db::table("\143\165\x73\x74\157\x6d\x65\162")->where($conditions)->page($page, $rows)->order($order)->field(true)->select(); goto CbaVN; t1kZk: $conditions["\x6f\x72\x67\x61\x6e\151\172\x61\164\151\x6f\156\x5f\151\x64"] = $search["\157\x72\x67\141\x6e\x69\172\x61\164\151\x6f\156\137\x69\x64"]; goto Lrw2B; Kylet: zfcuE: goto yxHe3; X_dn5: $totalCount = Db::table("\x63\165\x73\164\x6f\x6d\145\162")->where($conditions)->count(); goto rc79f; skpQz: $order = $sort . "\40" . $order; goto mpXcR; e1vGE: if (in_array($sort, ["\x72\145\x67\151\x73\164\x65\x72\137\164\151\155\x65", "\164\157\x74\x61\x6c\x5f\164\x65\x73\164\x5f\x71\x75\141\x6e\164\151\x74\x79", "\164\x6f\x74\141\x6c\x5f\164\x65\163\x74\x5f\141\x6d\157\x75\x6e\x74", "\x74\157\164\141\154\x5f\141\160\160\157\151\x6e\164\x5f\161\165\x61\x6e\164\x69\164\x79", "\x6c\141\x74\145\x73\x74\137\x6c\157\x67\151\x6e\137\x74\151\x6d\x65"])) { goto yDnDi; } goto g4xf6; g4xf6: $order = "\162\x65\147\151\163\x74\145\x72\x5f\x74\x69\155\x65\x20\144\145\163\143"; goto VlPi6; mpXcR: Gz4l8: goto T6FYJ; T6FYJ: $conditions = []; goto slQ_n; sAxtK: $conditions["\x63\x68\x61\156\156\x65\x6c\x5f\x69\144"] = $search["\143\x68\141\156\x6e\x65\x6c\x5f\x69\x64"]; goto zQgIL; zQgIL: XQeuS: goto yUKHA; FFeZv: yDnDi: goto skpQz; yUKHA: if (emptyInArray($search, "\x6f\x72\147\141\156\151\x7a\141\x74\x69\157\x6e\137\x69\144")) { goto FzNy_; } goto t1kZk; VlPi6: goto Gz4l8; goto FFeZv; CbaVN: foreach ($records as &$record) { goto X1S9J; X1S9J: if (!empty($record["\150\145\141\x64\151\x6d\x67\x5f\x75\162\154"])) { goto xoVSr; } goto i0PzY; b1K0N: Q1Buo: goto TGXmu; tYCkf: xoVSr: goto m2fhG; m2fhG: if (!empty($record["\x6e\151\x63\x6b\156\141\155\145"])) { goto tIhn1; } goto uCulE; i0PzY: $record["\150\145\141\x64\151\155\x67\137\x75\162\x6c"] = "\57\x73\164\141\x74\x69\x63\x2f\151\x6d\147\57\144\x65\x66\141\165\x6c\x74\56\160\156\147"; goto tYCkf; uCulE: $record["\156\x69\x63\x6b\x6e\x61\x6d\x65"] = ''; goto FA3DT; FA3DT: tIhn1: goto b1K0N; TGXmu: } goto Kylet; Queup: $conditions["\x72\145\141\154\137\x6e\141\155\145"] = ["\x6c\x69\153\x65", "\x25" . $search["\162\x65\x61\154\137\x6e\141\x6d\145"] . "\45"]; goto Mxc21; ObLt4: if (emptyInArray($search, "\x72\145\x61\x6c\x5f\x6e\141\x6d\145")) { goto vIyfW; } goto Queup; Lrw2B: FzNy_: goto X_dn5; nKM5J: $conditions["\156\151\143\x6b\x6e\141\x6d\x65"] = ["\154\x69\153\x65", "\45" . $search["\x6e\151\143\x6b\156\141\155\145"] . "\45"]; goto G5d1f; Mxc21: vIyfW: goto xOFTY; slQ_n: if (emptyInArray($search, "\156\x69\x63\x6b\156\x61\155\145")) { goto cesF4; } goto nKM5J; XCF07: eEP5u: goto psfLC; psfLC: if (emptyInArray($search, "\143\150\141\156\156\145\154\x5f\151\144")) { goto XQeuS; } goto sAxtK; O2bqL: } public function getInfos($customerId) { $infos = Db::table("\143\165\163\164\x6f\x6d\145\x72")->where("\151\x64", $customerId)->field(true)->find(); return $infos; } public function save($customerId, $data) { goto e1uGU; e1uGU: $customerModel = CustomerModel::get($customerId); goto Q2c_8; QilW0: exception("\xe6\x97\xa0\346\xb3\x95\346\211\xbe\345\x88\260\350\xaf\245\xe5\256\xa2\xe6\x88\267"); goto RuW74; uNzxP: $data["\x6d\157\x64\151\x66\x79\x5f\164\151\155\x65"] = date("\x59\55\155\x2d\x64\x20\x48\72\151\72\x73"); goto OR8tf; Q2c_8: if ($customerModel) { goto G2iEC; } goto QilW0; OR8tf: $customerModel->data($data, true)->allowField(true)->save(); goto RIyOu; RuW74: G2iEC: goto uNzxP; RIyOu: } }
