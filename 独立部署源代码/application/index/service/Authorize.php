<?php
 namespace app\index\service; use think\Log; use think\Db; use think\Debug; use app\index\service\RequestContext; class Authorize extends Base { protected function __construct() { } public function check($roleId, $menuId) { goto JaakP; JaakP: $adminRoleMenuTable = "\x61\144\x6d\151\x6e\x5f\x72\x6f\x6c\145\137\x6d\145\x6e\x75"; goto fGapV; llLzz: return $record ? $record : false; goto TwztZ; fGapV: $record = Db::table($adminRoleMenuTable)->where(array("\162\x6f\154\x65\137\151\x64" => $roleId, "\x6d\x65\x6e\165\137\151\144" => $menuId))->find(); goto llLzz; TwztZ: } public function checkPriv($roleId, $menuId) { goto TkK3i; Iaxn_: return false; goto rm2s0; gAhak: if (!empty($privType)) { goto S_320; } goto Iaxn_; TkK3i: $adminRoleMenuTable = "\x61\x64\x6d\151\x6e\137\x72\x6f\x6c\x65\137\155\x65\156\165"; goto FvCxH; rm2s0: S_320: goto y7_2S; FvCxH: $privType = Db::table($adminRoleMenuTable)->where(array("\x72\157\x6c\x65\137\151\144" => $roleId, "\155\x65\x6e\165\x5f\151\x64" => $menuId))->value("\164\x79\160\145"); goto gAhak; y7_2S: return $privType; goto Z0ZsP; Z0ZsP: } }
