<?php
 namespace app\mp\logic; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\mp\service\Subjects; use app\Defs; use app\index\logic\Subject as SubjectLogic; use EasyWeChat\Factory; use app\index\service\EventLogs as EventLogsService; class UniApp extends Base { public function login($channel, $code = '') { goto I70gb; G95dG: $openid = $loginResult["\x6f\160\x65\156\151\x64"]; goto t2eIr; t2eIr: $sessionKey = $loginResult["\163\x65\x73\x73\x69\157\x6e\x5f\x6b\x65\171"]; goto U6L0O; Yf_ts: goto eecYt; goto d12wS; ebdFo: goto qnwOK; goto o8069; U6L0O: eecYt: goto u_J5z; XIfyr: $loginResult = $this->_loginWeixin($code); goto G95dG; wupNC: $sessionKey = $loginResult["\x73\145\x73\x73\151\x6f\156\137\x6b\x65\x79"]; goto qPrdn; o8069: wlj0Q: goto Blxjb; kzK01: Db::table("\165\x6e\x69\137\x61\x70\160\x5f\165\x73\145\162\x73")->insert(["\x6f\x70\x65\x6e\151\x64" => $openid, "\x73\145\x73\163\x69\157\x6e\137\x6b\x65\x79" => $sessionKey, "\162\x65\x67\x69\x73\x74\x65\162\137\x74\x69\155\145" => Db::raw("\156\x6f\x77\x28\51"), "\154\x61\x74\x65\163\164\137\x6c\157\147\x69\156\x5f\164\x69\x6d\x65" => Db::raw("\x6e\157\167\x28\51"), "\x63\150\x61\156\156\145\154" => $channel]); goto ebdFo; eanIw: $openid = $loginResult["\157\160\145\156\x69\x64"]; goto wupNC; kUO8T: if (!$user["\x68\145\x61\144\151\155\147\137\165\162\x6c"]) { goto o6s5R; } goto M0CYL; Blxjb: Db::table("\165\156\151\137\141\x70\x70\x5f\x75\x73\145\x72\x73")->where("\x6f\x70\x65\156\151\144", $openid)->update(["\x73\x65\x73\163\151\x6f\156\137\x6b\145\x79" => $sessionKey, "\x6c\141\164\x65\163\x74\x5f\154\x6f\147\x69\x6e\137\164\x69\155\x65" => Db::raw("\x6e\x6f\x77\x28\x29")]); goto kUO8T; bhpFA: if ($channel == "\x57\x45\x49\130\111\x4e") { goto oIr7a; } goto pfnF_; g46Be: return ["\x73\145\163\163\151\x6f\156\x5f\153\145\171" => $sessionKey, "\150\x65\x61\144\151\x6d\147\x5f\165\162\x6c" => $headimgUrl]; goto lTUJV; M0CYL: $headimgUrl = generateUploadFullUrl($user["\x68\145\141\144\151\x6d\x67\x5f\165\x72\x6c"]); goto mXiyx; mXiyx: o6s5R: goto GutNv; GutNv: qnwOK: goto g46Be; YMtV4: CLC1B: goto fn3iF; Vl02s: $user = Db::table("\165\x6e\151\x5f\141\x70\x70\x5f\x75\x73\145\x72\x73")->where("\x6f\160\145\156\151\144", $openid)->field(true)->find(); goto JR6Du; JR6Du: if ($user) { goto wlj0Q; } goto kzK01; hMLvq: $channel = "\110\65"; goto Yf_ts; d12wS: oIr7a: goto XIfyr; lw2hl: $headimgUrl = generateUploadFullUrl("\x2f\x73\x74\141\x74\x69\x63\57\x69\x6d\x67\57\141\x76\x61\164\x61\x72\x2e\160\x6e\x67"); goto Vl02s; pfnF_: $openid = "\x6f\160\145\156\x69\144"; goto W7eVD; I70gb: if ($channel == "\102\x41\x49\104\125") { goto CLC1B; } goto bhpFA; u_J5z: goto V49zv; goto YMtV4; qPrdn: V49zv: goto lw2hl; fn3iF: $loginResult = $this->_loginBaidu($code); goto eanIw; W7eVD: $sessionKey = "\163\x65\163\163\x69\157\x6e\x5f\153\x65\171"; goto hMLvq; lTUJV: } private function _loginBaidu($code) { goto V5D4m; Qb2FK: $openid = $jsonObj["\x6f\x70\x65\156\x69\x64"]; goto MjZnd; jPN94: if (!($httpCode != "\62\x30\60")) { goto oj7b_; } goto EKzyc; gUhqf: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto Bhpdf; N2sRD: $jsonObj = json_decode($output, true); goto ii5gN; ANA0N: oj7b_: goto xT0zy; kPqBg: return ["\x6f\x70\x65\156\x69\x64" => $openid, "\163\145\x73\x73\x69\157\156\x5f\x6b\x65\171" => $sessionKey]; goto xetFq; S7MHl: $postDataArr = array("\143\x6f\144\x65" => $code, "\x63\x6c\151\x65\x6e\164\x5f\151\x64" => "\167\111\107\65\x41\157\161\152\114\x51\x64\102\x56\111\124\x7a\131\164\130\170\x49\170\104\x44\105\x30\161\x39\x52\x47\102\x4e", "\163\x6b" => "\107\x51\x41\70\71\165\123\130\166\x4f\106\x37\127\x4c\x4c\x51\150\x6e\102\x63\156\x6e\131\x37\x4e\x62\x31\123\x4e\125\x77\144"); goto DV1y8; WLBY0: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto gUhqf; WSzg5: exception("\346\227\240\346\xb3\x95\xe8\247\243\xe6\x9e\x90\x6f\x70\x65\x6e\151\144\72\x20" . $output); goto VXf7y; KtJ1k: $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); goto M8ZuC; Bhpdf: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto ytK2b; MjZnd: $sessionKey = $jsonObj["\163\145\163\163\x69\157\156\137\153\x65\171"]; goto kPqBg; DV1y8: $headerArr = array("\103\157\156\x74\145\156\x74\55\x74\171\x70\145\x3a\141\160\x70\154\x69\143\x61\164\x69\157\x6e\57\170\55\167\167\x77\x2d\x66\x6f\x72\x6d\x2d\x75\162\154\145\156\x63\x6f\144\145\x64"); goto fgRsO; V5D4m: $url = "\150\164\x74\160\x73\72\57\57\x73\x70\x61\160\x69\56\142\x61\151\x64\x75\56\x63\157\155\x2f\157\x61\165\x74\150\57\152\x73\x63\157\144\x65\x32\163\x65\163\163\x69\x6f\156\153\x65\x79"; goto S7MHl; vzWp8: $curl = curl_init(); goto SUPfJ; u_DJ3: $url .= http_build_query($postDataArr); goto auqji; M43LM: $errMsg = curl_error($curl); goto Wew41; ytK2b: $output = curl_exec($curl); goto PFmGG; QwxEX: $errCode = curl_errno($curl); goto M43LM; OvM2E: exception("\346\227\240\xe6\263\x95\350\xa7\243\346\x9e\x90\xe5\272\x94\347\xad\224\x3a\x20" . $output); goto cwl7e; fgRsO: $url .= "\x3f"; goto u_DJ3; auqji: Log::notice("\x62\141\151\x64\165\40\157\x61\x75\164\x68\40\162\x65\x71\x75\145\x73\x74\72\40" . var_export($postDataArr, true)); goto vzWp8; VXf7y: mTlbn: goto Qb2FK; EKzyc: exception("\347\231\276\xe5\272\246\345\272\224\xe7\255\x94\x68\164\164\x70\x20\x63\x6f\144\x65\x3a\x20{$httpCode}"); goto ANA0N; ii5gN: if (!empty($jsonObj)) { goto OM9EP; } goto OvM2E; CzEEY: if (isset($jsonObj["\x6f\160\x65\x6e\x69\144"])) { goto mTlbn; } goto WSzg5; PFmGG: if (!empty($output)) { goto ytsY8; } goto QwxEX; xT0zy: Log::notice("\142\141\151\144\165\x20\x6f\x61\x75\164\x68\x20\162\145\163\160\x6f\x6e\163\145\x3a\40{$output}"); goto N2sRD; M8ZuC: curl_close($curl); goto jPN94; SUPfJ: curl_setopt($curl, CURLOPT_URL, $url); goto WLBY0; kwSv7: exception("\xe6\x97\xa0\xe6\263\225\xe8\x8e\xb7\345\276\x97\347\231\xbe\xe5\272\xa6\346\234\x8d\xe5\212\xa1\xe5\x99\250\xe5\xba\224\xe7\255\x94\54\40{$errCode}\40\x2d\40{$errMsg}"); goto Ue9cZ; Ue9cZ: ytsY8: goto KtJ1k; Wew41: curl_close($curl); goto kwSv7; cwl7e: OM9EP: goto CzEEY; xetFq: } private function _loginWeixin($code) { goto EQ0UQ; ZI0Ie: exception("\345\xbe\xae\xe4\xbf\241\347\231\273\345\xbd\x95\xe5\272\x94\xe7\xad\x94\344\270\xba\xe7\251\xba"); goto Cb_M5; uAf66: exception("\345\276\256\xe4\277\xa1\347\231\273\345\275\225\345\244\261\xe8\264\xa5\x3a\40" . var_export($wxUser, true)); goto WPqvV; EQ0UQ: $app = Factory::miniProgram(config("\167\170\56\x6d\x69\156\x69\137\160\162\157\147\162\x61\155")); goto D4HlU; Gl4IH: $sessionKey = $wxUser["\163\145\x73\x73\151\x6f\x6e\x5f\153\145\x79"]; goto wOsye; DlPPy: Log::notice("\x77\145\151\x78\x69\156\x20\x6f\141\x75\164\x68\x20\x72\x65\163\x70\157\156\163\x65\72\x20" . var_export($wxUser, true)); goto YDa4v; D4HlU: $wxUser = $app->auth->session($code); goto QvzE9; WPqvV: u3vn7: goto DlPPy; SEgSS: if (!(!isset($wxUser["\x6f\x70\x65\156\151\144"]) || !isset($wxUser["\163\145\x73\163\x69\157\x6e\x5f\153\x65\x79"]))) { goto u3vn7; } goto uAf66; Cb_M5: ITWOu: goto SEgSS; wOsye: return ["\157\x70\x65\156\x69\x64" => $openid, "\163\x65\163\163\151\x6f\x6e\137\153\145\x79" => $sessionKey]; goto rRYCL; YDa4v: $openid = $wxUser["\x6f\160\145\x6e\x69\x64"]; goto Gl4IH; QvzE9: if ($wxUser) { goto ITWOu; } goto ZI0Ie; rRYCL: } public function logout($session_key) { Db::table("\165\x6e\x69\x5f\x61\x70\160\137\x75\163\x65\x72\163")->where("\163\x65\x73\x73\151\x6f\x6e\x5f\x6b\x65\171", $session_key)->update(["\x73\145\x73\x73\151\157\156\x5f\x6b\145\171" => '']); } public function subjectsPopular() { goto enTgY; QjWBw: VDzOt: goto fko5e; enTgY: $rows = Db::query("\163\145\x6c\145\143\164\x20\x69\144\54\40\156\141\155\x65\x2c\x20\163\165\x62\x74\x69\x74\154\x65\x2c\x20\x69\155\x61\x67\x65\137\165\x72\x6c\x2c\40\x62\x61\x6e\x6e\x65\x72\137\x69\x6d\x67\54\x20\x69\x74\145\x6d\163\x2c\40\160\141\x72\164\151\x63\x69\x70\x61\156\164\x73\x5f\x73\x68\x6f\167\x20\141\x73\40\x70\x61\x72\x74\x69\x63\x69\x70\x61\x6e\x74\x73\x2c\x20\x63\165\162\x72\x65\x6e\x74\137\160\162\x69\x63\145\40\15\xa\x9\x9\x9\x9\11\x9\x9\146\162\157\x6d\40\163\165\142\152\145\x63\164\40\15\12\x9\x9\11\x9\11\x9\x9\x77\150\145\x72\145\x20\106\111\116\104\x5f\111\116\x5f\123\105\x54\x28\47\160\x6f\x70\165\x6c\141\x72\47\54\40\154\141\x62\145\154\51\x20\x61\156\x64\x20\144\145\154\x65\164\145\x5f\x66\x6c\x61\x67\75\60\x20\x61\156\144\40\x73\164\141\164\165\163\x3d" . IndexDefs::ENTITY_PUBLISH_STATUS . "\x20\141\x6e\144\x20\165\x6e\151\x5f\141\160\x70\x3d\x31\15\xa\11\x9\11\x9\x9\x9\x9\117\x52\104\105\x52\40\x42\x59\x20\122\x41\116\104\x28\x29\x20\114\x49\115\111\124\x20\x34"); goto I09rI; fko5e: return $rows; goto innhv; I09rI: foreach ($rows as &$row) { goto DPLn8; jSZft: $row["\143\x61\164\x65\147\x6f\162\171\x5f\156\141\155\x65\163"] = $categoryNames; goto nA0h0; foKTu: $categoryNames = Db::table("\163\165\x62\x6a\x65\143\164\137\x63\141\164\145\147\157\x72\x79\137\x72\x65\x6c\x61\164\x65")->alias("\x53\x43\122")->join("\x63\x61\x74\x65\147\157\162\x69\x65\163\x20\x43", "\x53\103\122\56\x63\141\x74\145\x67\x6f\162\x79\137\151\144\75\103\56\151\144\40\141\x6e\x64\40\x53\103\122\56\163\165\142\152\145\143\164\x5f\x69\x64\75" . $row["\151\144"])->column("\103\56\156\141\x6d\x65"); goto jSZft; lL2sL: $row["\142\141\x6e\x6e\x65\162\137\x69\155\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto hhTxE; hhTxE: $row["\x70\x61\162\x74\x69\x63\151\x70\141\156\164\x73"] = formatTimes($row["\160\x61\x72\x74\151\x63\x69\x70\x61\156\x74\163"]); goto foKTu; DPLn8: $imageUrl = $row["\x69\x6d\141\147\145\x5f\x75\x72\x6c"]; goto FEnMh; nA0h0: r90LO: goto mCXP0; FEnMh: $row["\x69\x6d\141\147\x65\x5f\165\x72\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto lL2sL; mCXP0: } goto QjWBw; innhv: } public function subjectsFeatured() { goto ydom9; d7K9y: return $rows; goto BNqDJ; k82t2: foreach ($rows as &$row) { goto Hsk8V; HZoA4: $categoryNames = Db::table("\x73\165\142\x6a\x65\143\x74\137\143\x61\164\x65\x67\x6f\162\171\137\x72\x65\154\x61\x74\145")->alias("\x53\103\x52")->join("\143\141\164\x65\147\x6f\x72\x69\145\x73\x20\x43", "\x53\x43\122\x2e\x63\141\164\145\147\x6f\x72\x79\137\x69\144\75\x43\56\151\x64\40\141\156\x64\40\x53\x43\x52\56\163\165\142\x6a\x65\x63\x74\x5f\151\x64\75" . $row["\x69\x64"])->column("\103\x2e\x6e\x61\x6d\x65"); goto iqYAE; jXKuQ: $row["\160\141\x72\164\x69\x63\151\160\141\156\164\x73"] = formatTimes($row["\160\141\x72\164\x69\x63\x69\160\x61\x6e\x74\163"]); goto HZoA4; SfHMb: $row["\151\x6d\141\147\x65\x5f\x75\x72\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto P2fEL; iqYAE: $row["\x63\x61\x74\145\x67\157\162\x79\137\x6e\x61\155\145\163"] = $categoryNames; goto VxzTD; P2fEL: $row["\142\141\156\x6e\145\162\x5f\151\x6d\147"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto jXKuQ; VxzTD: y9sP6: goto UiYcl; Hsk8V: $imageUrl = $row["\x69\x6d\x61\x67\x65\137\165\x72\x6c"]; goto SfHMb; UiYcl: } goto tYbCo; ydom9: $rows = Db::query("\163\145\x6c\x65\x63\x74\40\151\x64\54\40\x6e\141\155\145\x2c\40\x73\x75\x62\164\151\164\154\x65\x2c\40\151\155\x61\147\x65\x5f\165\x72\x6c\54\x20\x62\141\x6e\156\145\162\137\x69\x6d\147\54\x20\x69\x74\x65\x6d\x73\x2c\x20\160\x61\162\164\x69\x63\151\x70\x61\x6e\x74\x73\x5f\163\x68\x6f\x77\x20\141\x73\40\x70\x61\162\164\151\143\x69\x70\141\156\x74\163\x2c\40\143\165\162\x72\x65\x6e\164\x5f\x70\x72\x69\143\145\x20\15\12\x9\x9\x9\x9\11\x9\x9\x66\162\157\x6d\x20\x73\x75\x62\152\145\x63\164\40\15\12\11\x9\x9\x9\x9\x9\11\x77\x68\x65\x72\145\40\x46\x49\x4e\104\137\x49\116\x5f\123\105\124\x28\x27\146\145\x61\164\x75\162\x65\x64\47\54\40\154\141\x62\145\x6c\x29\40\x61\x6e\x64\40\144\145\154\145\x74\145\x5f\x66\x6c\141\x67\75\x30\40\141\156\x64\40\163\164\141\164\165\163\75" . IndexDefs::ENTITY_PUBLISH_STATUS . "\x20\x61\156\144\x20\x75\156\151\137\x61\x70\x70\x3d\61\xd\xa\11\11\11\11\x9\11\11\x6f\162\144\145\162\40\142\x79\40\x73\157\x72\x74\x20\x61\x73\143"); goto k82t2; tYbCo: bt59Y: goto d7K9y; BNqDJ: } public function subjectsInCategory($categoryId, $kw) { goto Hokie; Al5Ek: foreach ($rows as &$row) { goto OGHDp; iFB5Q: $row["\x63\141\164\x65\147\x6f\162\171\x5f\156\x61\x6d\145\x73"] = $categoryNames; goto Ot78Q; BKFqb: $row["\x62\x61\156\x6e\145\x72\137\x69\155\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto vTF8Q; OGHDp: $imageUrl = $row["\x69\x6d\141\x67\145\137\165\x72\154"]; goto O2cxj; om1v6: $categoryNames = Db::table("\163\x75\142\152\145\143\164\137\x63\141\164\145\147\x6f\162\x79\137\x72\x65\x6c\141\x74\145")->alias("\x53\x43\122")->join("\143\x61\x74\145\x67\x6f\x72\x69\x65\163\40\103", "\123\103\x52\56\143\x61\x74\145\x67\x6f\162\x79\x5f\x69\144\x3d\103\56\x69\x64\x20\x61\156\x64\40\x53\x43\122\56\163\165\x62\x6a\x65\143\x74\x5f\151\x64\x3d" . $row["\151\144"])->column("\x43\x2e\x6e\x61\x6d\x65"); goto iFB5Q; Ot78Q: x6Waz: goto DGar4; vTF8Q: $row["\160\x61\162\164\151\143\x69\x70\x61\x6e\x74\x73"] = formatTimes($row["\160\x61\162\x74\x69\x63\x69\x70\141\x6e\x74\x73"]); goto om1v6; O2cxj: $row["\151\155\x61\147\x65\x5f\x75\x72\154"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto BKFqb; DGar4: } goto uYfu7; XCmTr: WxeUY: goto jtTn7; vPo5f: return $rows; goto ahFoX; m7mvP: Oux5d: goto Zzm5k; PSQh7: $where["\x53\56\x73\x74\141\x74\165\x73"] = ["\x69\x6e", [IndexDefs::ENTITY_PUBLISH_STATUS]]; goto rYT90; uYfu7: IBwbr: goto vPo5f; OqEyg: goto qq7c0; goto m7mvP; Zzm5k: if (!$kw) { goto WxeUY; } goto lN0n4; hKVz0: r2aVn: goto TlLMv; Dvnyi: $rows = Db::table("\x73\x75\142\152\x65\143\x74")->alias("\x53")->join("\x73\x75\x62\x6a\145\143\x74\137\143\141\164\145\147\x6f\x72\171\x5f\x72\x65\x6c\x61\x74\x65\40\123\x43\122", "\x53\x2e\x69\144\75\x53\x43\x52\x2e\x73\x75\142\x6a\145\x63\164\137\x69\x64\x20\x61\156\x64\x20\x53\x43\x52\56\x63\141\x74\x65\x67\157\162\171\137\151\x64\x3d" . $categoryId)->where($where)->order("\123\56\x73\157\162\x74\x20\x61\x73\x63")->field("\123\56\151\x64\54\123\x2e\156\x61\155\x65\54\x53\56\x73\165\142\164\151\164\x6c\145\x2c\x53\56\151\155\141\x67\145\x5f\x75\x72\154\54\x53\56\142\x61\x6e\x6e\x65\162\x5f\151\155\147\54\123\56\151\164\x65\x6d\x73\54\x53\56\160\x61\x72\x74\x69\143\x69\x70\141\x6e\x74\163\137\163\x68\x6f\x77\x20\x61\x73\40\x70\141\162\164\151\x63\151\160\141\156\164\163\54\123\56\143\x75\162\x72\x65\156\x74\137\x70\162\x69\143\145")->select(); goto f1ZL4; TlLMv: $where["\123\x2e\x63\165\162\x72\145\x6e\x74\137\x70\162\x69\143\x65"] = 0; goto FKcjo; rYT90: if ($categoryId == 0) { goto Oux5d; } goto GEApQ; jtTn7: $rows = Db::table("\163\165\x62\x6a\x65\x63\x74")->alias("\x53")->where($where)->order("\123\56\163\x6f\x72\x74\x20\x61\163\143")->field("\123\x2e\x69\144\54\123\x2e\156\x61\155\145\x2c\123\x2e\163\x75\142\164\151\x74\154\145\x2c\123\56\151\x6d\x61\147\x65\x5f\165\x72\154\x2c\x53\56\142\141\x6e\156\x65\162\x5f\151\155\x67\54\123\56\x69\x74\x65\x6d\163\x2c\123\56\160\x61\x72\164\x69\x63\151\160\141\x6e\x74\163\137\163\x68\x6f\167\x20\x61\163\x20\x70\141\x72\164\151\143\x69\160\141\x6e\x74\x73\x2c\123\56\143\x75\x72\x72\145\156\164\137\x70\x72\x69\x63\x65")->select(); goto Uh3OU; FKcjo: $rows = Db::table("\x73\165\x62\152\x65\143\x74")->alias("\x53")->where($where)->order("\123\56\163\157\162\x74\x20\x61\163\143")->field("\123\x2e\151\x64\x2c\123\x2e\x6e\x61\x6d\145\x2c\123\x2e\x73\165\142\164\x69\x74\x6c\x65\x2c\123\56\x69\x6d\x61\x67\145\x5f\x75\x72\x6c\54\123\56\x62\141\x6e\156\x65\x72\137\151\155\x67\54\x53\x2e\x69\x74\x65\155\163\x2c\123\56\160\141\162\x74\x69\143\151\160\141\x6e\x74\x73\x5f\163\150\157\x77\x20\141\163\40\160\141\162\x74\151\143\x69\x70\141\156\x74\163\54\123\x2e\x63\x75\x72\x72\145\x6e\x74\x5f\160\162\151\x63\145")->select(); goto LnNcC; Hokie: $where = ["\123\x2e\165\156\151\x5f\141\160\160" => 1]; goto XUwJL; XUwJL: $where["\123\56\x64\x65\154\x65\x74\x65\x5f\146\x6c\x61\x67"] = 0; goto PSQh7; Uh3OU: qq7c0: goto Al5Ek; f1ZL4: goto ae9mF; goto hKVz0; LnNcC: ae9mF: goto OqEyg; lN0n4: $where["\123\56\156\x61\x6d\145"] = ["\154\x69\x6b\145", "\45" . $kw . "\x25"]; goto XCmTr; GEApQ: if ($categoryId == -1) { goto r2aVn; } goto Dvnyi; ahFoX: } public function getSubject($login_user_id, $id) { goto OcId0; CTJOI: $record["\164\145\x61\155\x5f\142\x72\x69\145\x66"] = nl2br($record["\x74\x65\x61\155\x5f\x62\162\151\x65\146"]); goto NdwIq; Mj_HN: $record["\160\x61\x72\x74\151\143\151\x70\141\156\x74\x73"] = formatTimes($record["\x70\x61\162\x74\x69\143\x69\160\141\x6e\x74\163"]); goto ZOzlF; ZOzlF: $record["\x6f\162\x64\145\162\x5f\x6e\157"] = ''; goto Ke2aj; oODRB: $record["\x74\145\141\x6d\x5f\142\x72\151\x65\146"] = str_replace("\123\111\x54\x45\137\x55\x52\114", SITE_URL, $record["\x74\145\x61\x6d\x5f\x62\x72\x69\145\x66"]); goto CTJOI; NdwIq: $record["\162\145\160\157\162\x74\x5f\x64\x65\x6d\x6f\137\151\155\141\x67\145\x73"] = $record["\x72\145\160\157\x72\x74\x5f\144\145\x6d\157\x5f\x69\155\141\147\145\x73"] ? explode("\54", $record["\162\x65\x70\x6f\162\164\x5f\x64\145\155\157\x5f\151\155\x61\x67\x65\x73"]) : []; goto lCAwT; W8vz8: tmJHt: goto xpA3F; lCAwT: foreach ($record["\162\145\x70\157\x72\164\x5f\144\145\x6d\157\x5f\x69\x6d\141\x67\x65\163"] as $index => $image) { $record["\x72\x65\160\157\x72\164\137\144\x65\x6d\x6f\x5f\x69\x6d\x61\147\145\163"][$index] = generateUploadFullUrl($image); EE0P_: } goto tk5pH; QUVlu: xt9bV: goto W8vz8; Ke2aj: if (!$login_user_id) { goto tmJHt; } goto klnD6; A9ZAH: $record["\142\141\x6e\x6e\145\162\137\151\155\147"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto Mj_HN; OcId0: $record = Db::table("\x73\x75\142\x6a\x65\x63\164")->where(["\x69\x64" => $id])->field("\151\x64\x2c\15\xa\40\40\40\x20\40\x20\40\40\40\x20\40\40\x6e\x61\155\145\54\15\xa\40\40\x20\x20\40\40\x20\x20\40\x20\x20\40\x73\x75\x62\164\x69\164\154\145\x2c\15\12\x20\40\x20\40\40\40\40\x20\x20\x20\40\x20\143\165\162\162\x65\x6e\x74\x5f\x70\162\x69\x63\145\x2c\15\xa\40\x20\40\40\x20\40\40\40\40\40\40\x20\145\x78\160\x65\x63\164\137\x66\x69\x6e\x69\x73\150\x5f\164\x69\x6d\x65\x2c\15\xa\40\x20\x20\40\40\40\40\40\40\x20\40\40\x69\x74\x65\155\163\54\15\xa\x20\x20\x20\40\x20\x20\40\40\x20\x20\x20\40\x70\141\162\164\x69\143\x69\160\x61\x6e\x74\x73\137\163\x68\157\x77\x20\141\163\40\160\141\162\x74\151\143\x69\x70\141\x6e\164\163\x2c\xd\xa\40\40\40\x20\40\40\x20\x20\x20\40\x20\40\x73\165\142\x6a\145\x63\164\x5f\144\x65\x73\143\x2c\xd\xa\x20\x20\x20\40\x20\x20\x20\x20\x20\40\x20\x20\163\165\142\152\x65\x63\x74\137\164\151\160\x2c\15\xa\x20\x20\x20\40\40\40\40\40\x20\40\40\40\x69\155\141\x67\145\x5f\x75\x72\154\54\xd\xa\40\x20\40\40\40\40\40\40\40\x20\40\40\142\141\156\x6e\x65\162\137\x69\x6d\147\x2c\xd\xa\40\40\x20\40\40\40\x20\40\x20\x20\40\x20\x74\x65\x73\x74\137\141\154\x6c\157\x77\137\x62\x61\143\x6b\54\xd\xa\x20\40\x20\x20\40\x20\40\40\40\x20\x20\40\x74\x65\163\164\137\141\x6c\x6c\157\x77\x5f\x61\x6e\x73\x77\145\x72\x5f\145\155\160\164\x79\x2c\xd\xa\40\40\x20\x20\40\40\40\x20\x20\40\40\40\162\x65\160\x6f\x72\164\x5f\x64\145\155\x6f\137\151\x6d\141\147\x65\163")->find(); goto QGIZg; xpA3F: $record["\163\165\x62\x6a\x65\x63\x74\x5f\x74\x69\160"] = htmlspecialchars_decode($record["\163\x75\x62\152\145\x63\164\137\164\x69\x70"]); goto W3rMw; NHyxp: if (!$lastOrder) { goto xt9bV; } goto DwAV_; K3RHp: Jt1o7: goto ima4g; W3rMw: $record["\x74\x65\141\x6d\137\142\x72\x69\x65\146"] = "\x3c\160\x3e\344\270\x93\xe4\270\232\xe5\xbf\x83\xe7\220\x86\346\265\213\350\257\x84\xe7\xa0\224\345\x8f\221\345\x9b\242\xe9\230\237\xef\xbc\x8c\350\201\x9a\351\x9b\x86\xe5\x9b\xbd\xe5\206\x85\xe4\xbc\230\347\xa7\x80\xe7\x9a\204\345\277\x83\347\x90\x86\xe5\255\246\xe7\241\225\345\243\xab\xe5\x8f\x8a\xe4\xbb\245\344\xb8\212\xe4\xba\272\xe6\x89\x8d\x2c\345\205\xa8\xe9\x9d\242\xe6\xb6\265\347\233\226\xe5\xa9\232\345\247\xbb\346\x83\x85\xe6\204\x9f\xe3\200\x81\346\203\205\xe7\273\252\345\216\x8b\xe5\x8a\233\xe3\200\x81\344\272\xba\351\x99\205\345\x85\xb3\xe7\263\xbb\343\x80\201\xe4\xba\262\345\xad\x90\346\x95\231\xe8\x82\262\xe3\200\x81\xe8\201\214\xe4\270\232\xe5\x8f\x91\345\261\225\xe3\x80\x81\344\xb8\xaa\xe4\xba\xba\xe6\x88\220\351\225\xbf\347\xad\211\345\xa4\232\351\xa2\x86\345\237\x9f\347\232\204\xe5\xbf\x83\347\x90\206\346\265\213\xe8\257\x84\xe7\xa0\224\xe5\217\x91\xe3\200\x82\346\227\240\xe8\256\xba\xe4\275\240\xe5\206\205\xe5\xbf\203\xe5\255\x98\xe5\234\xa8\xe4\273\x80\344\271\210\xe6\xa0\xb7\347\x9a\x84\345\233\260\xe6\203\x91\357\274\x8c\xe9\x80\x9a\350\xbf\207\346\xb5\x8b\350\257\204\351\203\275\345\x8f\257\xe4\xbb\245\346\211\xbe\xe5\x88\xb0\xe7\xad\x94\346\xa1\x88\xe3\x80\x82\x3c\57\160\x3e\xd\xa\x3c\160\x3e\x3c\151\155\147\40\163\x72\143\75\42\x53\x49\x54\x45\x5f\125\122\x4c\x2f\x73\x74\x61\x74\151\143\57\151\x6d\x67\x2f\x62\141\x6e\156\145\x72\56\152\x70\147\x22\x20\163\164\171\154\x65\x3d\42\155\141\x78\x2d\167\151\144\x74\150\72\61\x30\60\x25\73\42\x3e\x3c\57\x70\76"; goto oODRB; tk5pH: aYB5w: goto Rte9C; nQG2Z: $record["\x69\x6d\141\147\145\x5f\165\162\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto A9ZAH; QGIZg: if ($record) { goto Jt1o7; } goto KdSY9; Rte9C: return $record; goto QDlpn; klnD6: $lastOrder = Db::table("\165\156\x69\x5f\141\x70\160\137\157\162\144\145\162\x73")->where(["\165\x73\x65\162\137\x69\x64" => $login_user_id, "\x73\165\142\x6a\x65\143\164\137\151\144" => $id, "\x66\x69\156\151\x73\150\x65\144" => 0])->field("\x6f\x72\x64\x65\x72\x5f\x6e\x6f")->find(); goto NHyxp; ByE3K: $imageUrl = $record["\x69\x6d\141\x67\145\x5f\165\162\154"]; goto nQG2Z; TpttP: $record["\163\165\142\x6a\145\143\164\137\144\x65\x73\143"] = preg_replace("\57\74\133\x69\x6d\147\x7c\111\115\x47\135\56\x2a\x3f\163\x72\x63\x3d\133\47\174\x5c\42\x5d\50\x2e\x2a\77\51\133\x27\x7c\x5c\42\135\x2f", "\74\x69\155\147\40\163\x72\143\x3d\x22" . SITE_URL . "\44\x7b\61\x7d\42", $record["\163\x75\x62\x6a\145\x63\x74\137\144\x65\163\143"]); goto ByE3K; ima4g: $record["\163\x75\142\x6a\145\143\x74\x5f\144\145\163\x63"] = htmlspecialchars_decode($record["\x73\165\x62\x6a\145\x63\x74\137\144\x65\x73\x63"]); goto TpttP; KdSY9: wexception("\346\227\240\346\xb3\x95\346\211\276\xe5\x88\260\xe8\257\245\346\xb5\x8b\xe8\257\x84"); goto K3RHp; DwAV_: $record["\157\162\x64\145\x72\137\156\157"] = $lastOrder["\x6f\162\x64\x65\x72\x5f\156\157"]; goto QUVlu; QDlpn: } protected function getOrderByNo($order_no) { goto lQZiZ; rqzf9: $row = Db::table("\165\x6e\151\137\141\160\160\137\157\162\144\x65\x72\x73")->where(["\x6f\x72\x64\x65\x72\137\x6e\157" => $order_no])->field("\x2a")->find(); goto Mz562; ubhea: return []; goto pd63H; sxf_Y: return $row; goto yevIR; mWeDP: if ($result && isset($result["\x72\145\x70\157\162\x74\114\x69\163\164"])) { goto ueHXb; } goto qT259; jad7i: v_NDF: goto wmvsG; pd63H: Dr0A1: goto rqzf9; lQZiZ: if (!empty($order_no)) { goto Dr0A1; } goto ubhea; gJSyO: $row["\162\145\160\x6f\162\164\137\x6c\151\x73\164"] = []; goto izeCh; Mz562: if (!($row && !empty($row["\162\145\x73\165\x6c\x74"]))) { goto I0cds; } goto d5buQ; wmvsG: I0cds: goto sxf_Y; d5buQ: $result = json_decode($row["\162\145\163\165\154\164"], true); goto mWeDP; A7svN: ueHXb: goto wluTn; wluTn: $row["\x72\145\x70\x6f\x72\164\137\x6c\x69\x73\164"] = $result["\x72\x65\160\x6f\162\x74\114\151\x73\x74"]; goto jad7i; izeCh: goto v_NDF; goto A7svN; qT259: Log::error("\146\141\151\154\145\x64\40\x74\157\40\x64\145\x63\x6f\144\145\x20\162\145\x73\165\154\164\x20\x66\x6f\162\x20\x73\165\142\x6a\145\x63\x74\x20\157\x72\144\145\162\x3a\40{$order_no}"); goto gJSyO; yevIR: } public function createOrder($login_user_id, $id, $order_no) { goto OL1OC; dCrKv: goto DhQY8; goto WtKt0; S2sYV: $order = ["\157\162\x64\145\162\137\x6e\157" => "\125\x4e\x49" . date("\x79\155\x64\x48\151\163") . $login_user_id, "\165\x73\x65\x72\x5f\x69\x64" => $login_user_id, "\x73\x75\142\152\145\x63\x74\137\x69\144" => $id, "\157\x72\144\145\162\137\141\155\157\165\x6e\164" => $subject["\143\165\x72\162\x65\156\164\x5f\x70\x72\x69\x63\x65"], "\x6f\x72\x64\145\x72\x5f\x74\151\155\x65" => date("\x59\x2d\155\55\x64\x20\x48\72\151\72\x73"), "\164\157\164\x61\154\137\151\x74\145\x6d\x73" => $subject["\151\x74\x65\x6d\x73"], "\x70\x61\171\x5f\163\x74\141\164\x75\x73" => $subject["\x63\165\162\x72\145\156\x74\x5f\x70\x72\x69\x63\145"] > 0 ? Defs::PAY_WAIT : Defs::PAY_SUCCESS, "\x69\x74\x65\155\x5f\x76\145\x72\163\151\x6f\x6e" => $subject["\x69\x74\145\x6d\137\x76\145\162\x73\151\157\x6e"]]; goto QLRhh; TvS33: RVW4W: goto dCrKv; tUA0W: wexception("\xe6\227\240\xe6\263\225\xe6\x89\xbe\xe5\x88\xb0\350\xaf\xa5\xe6\265\x8b\xe8\xaf\204\351\x87\217\350\241\250"); goto VidZP; bXxOs: $row = $this->getOrderByNo($order_no); goto Hp6hM; APD0K: DhQY8: goto iEzB5; n44NN: wexception("\346\xb5\x8b\xe8\xaf\204\351\207\x8f\350\xa1\xa8\xe5\x8c\205\xe5\220\xab\347\x9a\x84\xe9\242\x98\347\x9b\256\344\270\xba\xe7\xa9\xba"); goto T7d4N; QLRhh: $res = Db::table("\165\156\151\137\141\160\x70\x5f\157\162\144\x65\x72\x73")->insert($order); goto KTIhO; TEyp5: if (!empty($subject)) { goto hLbOc; } goto tUA0W; WtKt0: ltbmT: goto bXxOs; VidZP: hLbOc: goto DIROg; vU0TN: if ($order_no) { goto ltbmT; } goto S2sYV; DKOu6: ViUvd: goto MNuP6; MNuP6: $order = ["\157\x72\144\x65\162\x5f\156\157" => $row["\157\x72\x64\x65\x72\x5f\156\x6f"], "\165\x73\x65\x72\x5f\x69\144" => $row["\165\163\145\162\x5f\x69\x64"], "\163\165\x62\152\x65\x63\x74\x5f\x69\x64" => $row["\x73\x75\142\152\x65\x63\x74\x5f\151\x64"], "\x6f\162\x64\x65\x72\137\141\x6d\x6f\165\156\x74" => $row["\157\x72\x64\145\162\137\x61\155\x6f\x75\156\x74"], "\157\162\144\145\x72\x5f\x74\x69\155\145" => $row["\x6f\162\144\145\x72\x5f\164\x69\x6d\x65"], "\164\x6f\x74\141\154\137\x69\x74\145\155\x73" => $row["\x74\x6f\164\x61\x6c\x5f\x69\x74\x65\155\163"], "\160\141\x79\x5f\x73\x74\x61\164\165\x73" => $row["\160\141\171\x5f\x73\x74\141\164\165\163"]]; goto APD0K; Hp6hM: if (!empty($row)) { goto ViUvd; } goto Vk8Et; KTIhO: if (!empty($res)) { goto RVW4W; } goto nn8LJ; nn8LJ: wexception("\346\225\xb0\346\215\256\xe5\xba\x93\351\x94\x99\350\257\xaf"); goto TvS33; OL1OC: $subject = Db::table("\163\x75\142\152\145\143\164")->where(["\x69\144" => $id])->field("\52")->find(); goto TEyp5; iEzB5: return $order["\x6f\x72\144\x65\x72\x5f\156\x6f"]; goto Gds9t; T7d4N: MiH62: goto vU0TN; DIROg: if (!($subject["\151\x74\x65\x6d\163"] == 0)) { goto MiH62; } goto n44NN; Vk8Et: wexception("\xe6\x97\240\xe6\263\225\346\211\xbe\345\x88\260\350\257\xa5\350\xae\xa2\xe5\x8d\x95"); goto DKOu6; Gds9t: } public function regenOrder($order_no) { goto CzRtk; JfVX1: if (!empty($subject)) { goto uWbPM; } goto U2_BG; AL_11: $order["\143\165\162\x72\x5f\x69\164\x65\x6d"] = 0; goto tDL5l; a19cp: $order = []; goto X2Yx8; X2Yx8: $order["\164\157\x74\x61\154\137\x69\x74\145\x6d\x73"] = $subject["\x69\164\145\x6d\x73"]; goto Ipd1j; T8Igm: uWbPM: goto a19cp; RIzyT: $subject = Db::table("\163\x75\x62\152\145\x63\x74")->where(["\151\x64" => $order["\x73\x75\142\x6a\x65\x63\164\137\x69\144"]])->field("\x2a")->find(); goto JfVX1; tDL5l: $order["\x69\164\145\x6d\163"] = ''; goto k_nHv; PEdHI: Db::table("\x75\156\x69\x5f\x61\x70\160\x5f\157\x72\x64\x65\162\x73")->where("\157\162\144\x65\x72\137\x6e\x6f", $order_no)->update($order); goto hIMw7; Ipd1j: $order["\164\x65\163\x74\137\151\164\145\x6d\163"] = 0; goto AL_11; U2_BG: wexception("\xe6\xb5\213\xe8\xaf\x84\xe4\xb8\x8d\xe5\255\230\345\x9c\xa8"); goto T8Igm; pEuxQ: $order["\146\x69\x6e\x69\x73\150\x65\144"] = 0; goto pXPVK; l8VoR: if (!empty($order)) { goto P5vmL; } goto MadTZ; pXPVK: $order["\x69\x74\x65\x6d\x5f\x76\145\x72\x73\151\x6f\x6e"] = $subject["\151\164\145\155\x5f\166\x65\x72\163\x69\157\156"]; goto PEdHI; MadTZ: wexception("\xe6\xb5\213\xe8\257\x84\xe8\256\242\345\x8d\225\344\270\x8d\345\xad\x98\345\234\250\357\xbc\232" . $order_no); goto MaF5j; k_nHv: $order["\x72\x65\163\x75\154\164"] = null; goto pEuxQ; CzRtk: $order = $this->getOrderByNo($order_no); goto l8VoR; MaF5j: P5vmL: goto RIzyT; hIMw7: } public function makeTestSubjectItems($items, $subjectItems) { goto NsMkR; lJUWH: foreach ($itemExists as $itemExist) { goto d4aH6; RusLu: $itemIdExist = $itemSections[0]; goto ny4kS; V1POo: if (!(count($itemSections) != 3)) { goto YCHsm; } goto Xhf4N; d4aH6: $itemSections = explode("\x26", $itemExist); goto V1POo; JCLk1: $itemValueExist = $itemSections[2]; goto tPPmK; Xhf4N: goto SjdyH; goto hEIa2; tPPmK: $subjectItemsExist[$itemIdExist] = ["\x74\x79\x70\x65" => $itemTypeExist, "\166\141\x6c\165\x65" => $itemTypeExist == Defs::QUESTION_CHECKBOX ? explode("\55", $itemValueExist) : $itemValueExist]; goto K58K0; ny4kS: $itemTypeExist = $itemSections[1]; goto JCLk1; K58K0: SjdyH: goto J8Lwk; hEIa2: YCHsm: goto RusLu; J8Lwk: } goto APS0D; NsMkR: if (!$items) { goto Rw5I2; } goto VYYBk; ogbRj: $index = 0; goto lT0Xc; GWW4W: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto WBH5E; WBH5E: if (!(isset($subjectItemsExist[$subjectItemId]) && $subjectItem["\164\x79\x70\145"] == $subjectItemsExist[$subjectItemId]["\x74\171\160\x65"])) { goto Nct0f; } goto WysVQ; r5_rr: fjDEu: goto rkQEn; WysVQ: $subjectItem["\x76\141\154\x75\145"] = $subjectItemsExist[$subjectItemId]["\x76\141\x6c\165\145"]; goto GX_ml; GX_ml: Nct0f: goto r5_rr; rkQEn: } goto JuWGW; r0Jx2: Rw5I2: goto G4RqJ; lT0Xc: foreach ($subjectItems as $key => $item) { goto hSXXY; AfnUk: if (!($index < count($subjectItems) - 1)) { goto pdP2Y; } goto AiCK4; S84rr: pdP2Y: goto jO9bT; Oi1Q8: $item["\x70\x72\145\166\x5f\151\144"] = "\x69\x64\x5f" . $item["\x70\x72\145\166\137\x69\x64"]; goto x3JPQ; yKiH2: $index++; goto fs2Bn; fs2Bn: P1j8c: goto Ov40Z; x3JPQ: TKJ6Z: goto AfnUk; hSXXY: if (!($index > 0)) { goto TKJ6Z; } goto Oi1Q8; jO9bT: $subjectItemsClone["\x69\144\137" . $key] = $item; goto yKiH2; AiCK4: $item["\x6e\x65\x78\x74\x5f\151\x64"] = "\151\144\x5f" . $item["\156\145\170\164\x5f\151\x64"]; goto S84rr; Ov40Z: } goto BBIbv; APS0D: fbFCp: goto GWW4W; UvM3K: $itemExists = explode("\54", $items); goto lJUWH; VYYBk: $subjectItemsExist = []; goto UvM3K; J2t7t: $subjectItemsClone = []; goto ogbRj; G4RqJ: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto GE0qf; KbJ8s: $imageField = "\x69\x6d\141\x67\x65\137" . $optionIndex; goto pC6Mo; FxZyz: iBq_e: goto Uvo3R; WIsiy: $subjectItem[$imageField] = generateUploadFullUrl(generateThumbnailUrl($subjectItem[$imageField], 100)); goto FxZyz; S87ZL: YocO3: goto V3fJ1; Uvo3R: $optionIndex++; goto srpUR; Ca1nU: $subjectItem["\x69\155\141\147\x65"] = generateUploadFullUrl(generateThumbnailUrl($subjectItem["\x69\x6d\141\x67\x65"], 200)); goto kHoso; u27Py: ugBId: goto JJ9Lw; S1opS: $optionIndex = 1; goto u27Py; srpUR: goto ugBId; goto S87ZL; pC6Mo: if (!$subjectItem[$imageField]) { goto iBq_e; } goto WIsiy; GE0qf: if (!$subjectItem["\x69\x6d\141\x67\145"]) { goto SEwx1; } goto Ca1nU; V3fJ1: hsK_1: goto iM73Y; kHoso: SEwx1: goto S1opS; JJ9Lw: if (!($optionIndex <= 12)) { goto YocO3; } goto KbJ8s; iM73Y: } goto UMMPV; NhoFX: return $subjectItemsClone; goto dwrm_; JuWGW: X8jwo: goto r0Jx2; BBIbv: aHHxS: goto NhoFX; UMMPV: JKVVD: goto J2t7t; dwrm_: } public function answer($order_no, $item_id, $item_type, $item_option) { try { goto TrcAb; KxY0W: if (!empty($item)) { goto LTqZ8; } goto BmTSh; T5IFv: $item_option = str_replace("\54", "\x3b", $item_option); goto q7n7f; tugkt: $item_option = htmlspecialchars($item_option); goto Hbf0h; sHOYm: $update["\x69\164\x65\x6d\163"] = join("\x2c", $answer); goto THqEb; Hbf0h: XSljt: goto i3lXN; muInv: $update["\x66\x69\x6e\151\163\150\x5f\164\x69\x6d\145"] = date("\131\55\155\55\x64\x20\110\x3a\x69\x3a\x73"); goto QRgOh; xYCQH: $item_option = []; goto aNeUd; q7n7f: $item_option = str_replace("\46", "\40", $item_option); goto tugkt; dr1z9: $update["\x74\x65\x73\164\137\151\164\x65\155\x73"] = count($answer) + 1; goto Hdwms; c9aJ4: $item_option = htmlspecialchars_decode($item_option); goto g9M9n; i3lXN: $answer[$item_id] = $item_id . "\x26" . $item_type . "\x26" . $item_option; goto sHOYm; qPdbj: $order = array_merge($order, $update); goto LUivQ; Hdwms: goto ANvdW; goto LRURl; BmTSh: exception("\xe8\xaf\x84\xe6\xb5\x8b\xe9\xa2\x98\xe7\233\256\344\270\x8d\xe5\255\230\xe5\234\xa8\xef\274\232" . $item_id); goto fkwYB; TrcAb: $order = $this->getOrderByNo($order_no); goto roXL7; qGzMH: if ($item_type == Defs::QUESTION_TEXT) { goto ZKDTx; } goto px0Sl; vcv7n: D27Kg: goto aTRDk; AU6XV: if (!empty($subject)) { goto ixUOY; } goto rL7yv; TqJIb: CldeJ: goto eCHkg; BVSjk: $update = []; goto CAmWm; khLvP: $update["\162\145\x73\165\154\164"] = json_encode(["\162\145\x70\157\x72\x74\114\x69\x73\164" => $result], JSON_UNESCAPED_UNICODE); goto cb2tk; yZWL4: dv0gV: goto D1ICc; t3XH9: $update["\x74\x65\x73\164\x5f\151\164\x65\155\x73"] = 1; goto Gl0pl; F3AoZ: exception("\346\227\xa0\xe6\xb3\x95\xe6\x89\276\345\x88\xb0\350\xaf\245\xe6\265\x8b\350\xaf\204\xe8\xae\242\xe5\x8d\x95"); goto l4N58; px0Sl: if (!($item_type == Defs::QUESTION_CHECKBOX)) { goto OdDqJ; } goto nWzss; q6wrS: if ($order["\164\x65\163\x74\x5f\151\164\145\x6d\x73"] == "\60") { goto Umi26; } goto S34zg; xcCy3: if (!$order["\x66\151\x6e\151\163\x68\145\x64"]) { goto D27Kg; } goto QPFtx; VYHsI: Db::table("\x75\156\151\137\x61\160\160\137\x6f\x72\144\x65\162\163")->where(["\157\162\x64\145\162\137\156\157" => $order_no])->update($update); goto qPdbj; l4N58: tNj3k: goto xcCy3; kLKvl: if (!is_string($item_option)) { goto dv0gV; } goto c9aJ4; nhj96: OdDqJ: goto VRBck; g9M9n: $item_option = json_decode($item_option, true); goto yZWL4; gVsIw: $answer = []; goto q6wrS; VRBck: goto XSljt; goto qgxkL; qgxkL: ZKDTx: goto NGNdi; nWzss: if (!empty($item_option)) { goto lE7iA; } goto xYCQH; D1ICc: $item_option = join("\55", $item_option); goto nhj96; aTRDk: $subject = Subjects::I()->getSubjectById($order["\163\x75\x62\152\x65\143\x74\x5f\x69\x64"]); goto AU6XV; OnP7n: exception("\xe9\x87\217\350\xa1\250\xe9\xa1\271\347\x9b\256\xe4\xb8\x8d\345\255\230\xe5\234\xa8"); goto TqJIb; N4RCl: exception("\xe9\207\217\350\xa1\xa8\xe9\242\230\347\x9b\256\xe4\xb8\x8d\345\xad\230\345\234\xa8"); goto Q1Uf6; aNeUd: lE7iA: goto kLKvl; fkwYB: LTqZ8: goto BVSjk; rL7yv: exception("\350\xaf\xa5\xe6\xb5\x8b\350\xaf\204\350\xae\xa2\xe5\x8d\225\345\205\263\xe8\x81\224\xe9\207\217\xe8\xa1\250\xe4\xb8\242\345\xa4\xb1\xef\xbc\232" . $order_no); goto ibF4D; cb2tk: ZhQMS: goto VYHsI; CAmWm: $update["\x63\x75\x72\x72\x5f\151\x74\x65\x6d"] = $item_id; goto gVsIw; LRURl: Umi26: goto t3XH9; puo_f: $subjectItems = Subjects::I()->getSubjectItems($order["\x73\x75\x62\x6a\x65\x63\x74\x5f\x69\144"]); goto X8BfB; QRgOh: $result = SubjectLogic::I()->generateTestResult($order["\x73\x75\x62\152\x65\x63\164\137\151\144"], Subjects::I()->parseOrderItems($update["\x69\x74\x65\x6d\163"])); goto d8ZY_; Gl0pl: ANvdW: goto qGzMH; tYOIY: array_walk($result, function ($item) use(&$update) { goto MfjX8; oJv1W: o1E1c: goto RReyp; zI33J: if (!($item["\167\x61\162\x6e\x69\x6e\147\137\154\145\x76\145\x6c"] > $update["\x77\x61\162\156\151\x6e\x67\x5f\154\145\x76\145\154"])) { goto o1E1c; } goto y0XzJ; y0XzJ: $update["\x77\141\162\x6e\x69\x6e\x67\137\154\x65\166\x65\x6c"] = $item["\x77\x61\x72\156\x69\x6e\x67\137\154\x65\x76\145\154"]; goto oJv1W; u_o3h: FRpS_: goto zI33J; MfjX8: if (isset($item["\167\141\x72\156\x69\156\x67\x5f\154\145\x76\x65\x6c"])) { goto FRpS_; } goto TiGIh; TiGIh: return; goto u_o3h; RReyp: }); goto khLvP; CH2Ix: $item = $subjectItems[$item_id]; goto KxY0W; THqEb: if (!empty($item["\156\x65\x78\164\137\151\144"])) { goto ZhQMS; } goto gcCKY; roXL7: if (!empty($order)) { goto tNj3k; } goto F3AoZ; RxOzu: exception("\346\xb5\213\350\xaf\x84\351\241\271\xe7\233\256\347\211\210\346\x9c\254\xe5\217\221\347\224\x9f\344\xba\x86\345\217\230\xe6\233\xb4\357\274\214\xe9\x9c\200\350\xa6\x81\xe9\x87\215\xe6\226\260\346\xb5\213\xe8\257\204", -1); goto zheul; eCHkg: if (isset($subjectItems[$item_id])) { goto mueFa; } goto N4RCl; gcCKY: $update["\x66\151\x6e\151\163\x68\x65\x64"] = 1; goto muInv; xFBsx: LefgO: goto dr1z9; zheul: co2pb: goto puo_f; cfSs0: foreach ($itemExists as $itemExist) { goto hJGPZ; hJGPZ: $itemIdExist = explode("\46", $itemExist)[0]; goto tvgvm; A7o2L: $answer[$itemIdExist] = $itemExist; goto Zp31G; krwiH: tTSpl: goto A7o2L; Zp31G: mqo5o: goto Dznu3; tvgvm: if (!($itemIdExist == $item_id)) { goto tTSpl; } goto LsLOS; LsLOS: goto LefgO; goto krwiH; Dznu3: } goto xFBsx; eHRkr: if (!($order["\151\x74\x65\x6d\137\166\x65\162\x73\x69\157\x6e"] != $subject["\x69\164\x65\155\137\x76\x65\x72\x73\x69\157\156"])) { goto co2pb; } goto RxOzu; NGNdi: $item_option = htmlspecialchars_decode($item_option); goto T5IFv; d8ZY_: $update["\x77\x61\162\156\151\156\147\x5f\154\145\x76\x65\x6c"] = Defs::MEASURE_WARNING_UNKOWN_LEVEL; goto tYOIY; QPFtx: exception("\xe6\265\x8b\350\xaf\x84\xe5\267\262\345\xae\x8c\xe6\x88\220"); goto vcv7n; X8BfB: if (!empty($subjectItems)) { goto CldeJ; } goto OnP7n; ibF4D: ixUOY: goto eHRkr; Q1Uf6: mueFa: goto CH2Ix; S34zg: $itemExists = explode("\x2c", $order["\151\x74\x65\155\x73"]); goto cfSs0; LUivQ: } catch (\Exception $e) { goto RC28j; hea3m: wexception("\346\xb5\x8b\350\257\204\351\241\271\347\x9b\xae\xe7\x89\x88\346\x9c\xac\xe5\x8f\230\xe6\233\xb4", -1); goto wVXPK; wVXPK: lwZlV: goto mXSjr; mXSjr: wexception($e->getMessage()); goto ZD7Gv; RC28j: $exceptionCode = $e->getCode(); goto EpZRq; EpZRq: if (!($exceptionCode == -1)) { goto lwZlV; } goto hea3m; ZD7Gv: } return ["\146\x69\x6e\151\163\x68\145\x64" => $order["\x66\x69\156\x69\x73\150\145\x64"]]; } }
